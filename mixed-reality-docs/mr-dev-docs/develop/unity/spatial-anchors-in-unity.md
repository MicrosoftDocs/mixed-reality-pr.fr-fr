---
title: Verrouillage universel et ancrages spatiaux dans Unity
description: Découvrez comment utiliser les outils de verrouillage universel et les ancres spatiales dans les applications de réalité mixte Unity.
author: hferrone
ms.author: v-hferrone
ms.date: 04/7/2021
ms.topic: article
keywords: Unity, ancres spatiales, magasin d’ancrage, HoloLens, casque de réalité mixte, casque de réalité mixte, casque de réalité virtuelle, outils de verrouillage universel, hologrammes
ms.openlocfilehash: 4fc982244a766bb34f15b356d608f2aad18f7a88
ms.sourcegitcommit: 3e36b2fbbcc250c49aaf8ca1b6133cf0e9db69fa
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/16/2021
ms.locfileid: "107528804"
---
# <a name="world-locking-and-spatial-anchors-in-unity"></a><span data-ttu-id="e1276-104">Verrouillage universel et ancrages spatiaux dans Unity</span><span class="sxs-lookup"><span data-stu-id="e1276-104">World locking and spatial anchors in Unity</span></span>

![Image du héros de l’outil de verrouillage universel](images/wlt-img-01.jpeg)

<span data-ttu-id="e1276-106">La mise en place de vos hologrammes, le déplacement avec vous ou, dans certains cas, la position par rapport à d’autres hologrammes est une partie importante de la création d’applications de réalité mixte.</span><span class="sxs-lookup"><span data-stu-id="e1276-106">Getting your holograms to stay in place, move with you, or in some cases position themselves relative to other holograms is a big part of creating Mixed Reality applications.</span></span> <span data-ttu-id="e1276-107">Cet article vous guide tout au long de la solution recommandée à l’aide des outils de verrouillage universel, mais nous aborderons également la configuration manuelle des ancres spatiales dans vos projets Unity.</span><span class="sxs-lookup"><span data-stu-id="e1276-107">This article will take you through our recommended solution using World Locking Tools, but we'll also cover manually setting up spatial anchors in your Unity projects.</span></span> <span data-ttu-id="e1276-108">Avant de passer à un code, il est important de comprendre comment Unity gère l’espace de coordonnées et les ancres dans son propre moteur.</span><span class="sxs-lookup"><span data-stu-id="e1276-108">Before we jump into any code, it's important to understand how Unity handles coordinate space and anchors in its own engine.</span></span>

## <a name="world-scale-coordinate-systems"></a><span data-ttu-id="e1276-109">Systèmes de coordonnées à l’échelle mondiale</span><span class="sxs-lookup"><span data-stu-id="e1276-109">World-scale coordinate systems</span></span>

<span data-ttu-id="e1276-110">Aujourd’hui, lors de l’écriture de jeux, d’applications de visualisation de données ou d’applications de réalité virtuelle, l’approche classique consiste à établir un **système de coordonnées universel** unique sur lequel toutes les autres coordonnées peuvent être mappées de manière fiable.</span><span class="sxs-lookup"><span data-stu-id="e1276-110">Today, when writing games, data visualization apps, or virtual reality apps, the typical approach is to establish one absolute **world coordinate system** that all other coordinates can reliably map back to.</span></span> <span data-ttu-id="e1276-111">Dans cet environnement, vous pouvez toujours trouver une transformation stable qui définit une relation entre deux objets dans ce monde.</span><span class="sxs-lookup"><span data-stu-id="e1276-111">In that environment, you can always find a stable transform that defines a relationship between any two objects in that world.</span></span> <span data-ttu-id="e1276-112">Si vous n’avez pas déplacé ces objets, leurs transformations relatives restent toujours les mêmes.</span><span class="sxs-lookup"><span data-stu-id="e1276-112">If you didn't move those objects, their relative transforms would always remain the same.</span></span> <span data-ttu-id="e1276-113">Ce type de système de coordonnées global est facile à trouver lors du rendu d’un monde purement virtuel où vous connaissez toute la géométrie à l’avance.</span><span class="sxs-lookup"><span data-stu-id="e1276-113">This kind of global coordinate system is easy to get right when rendering a purely virtual world where you know all of the geometry in advance.</span></span> <span data-ttu-id="e1276-114">Aujourd’hui, les applications de la mise à l’échelle de la salle établissent généralement ce type de système de coordonnées à l’échelle de la pièce, avec son origine sur le plancher.</span><span class="sxs-lookup"><span data-stu-id="e1276-114">Room-scale VR apps today typically establish this kind of absolute room-scale coordinate system with its origin on the floor.</span></span>

<span data-ttu-id="e1276-115">En revanche, un appareil de réalité mixte non attaché, tel que HoloLens, a une compréhension dynamique pilotée par les capteurs du monde, en ajustant en permanence ses connaissances dans le temps de l’environnement de l’utilisateur lorsqu’il parcourt de nombreux compteurs à travers l’ensemble d’un étage d’un bâtiment.</span><span class="sxs-lookup"><span data-stu-id="e1276-115">In contrast, an untethered mixed reality device such as HoloLens has a dynamic sensor-driven understanding of the world, continuously adjusting its knowledge over time of the user's surroundings as they walk many meters across an entire floor of a building.</span></span> <span data-ttu-id="e1276-116">Dans le cas d’une expérience à l’échelle mondiale, si vous avez placé tous vos hologrammes dans un système de coordonnées rigides naïve, ces hologrammes finissent par être décomposés au fil du temps, soit en se basant sur le monde, soit de l’un par rapport à l’autre.</span><span class="sxs-lookup"><span data-stu-id="e1276-116">In a world-scale experience, if you placed all your holograms in a naive rigid coordinate system, those holograms would end up drifting over time, either based on the world or relative to each other.</span></span>

<span data-ttu-id="e1276-117">Par exemple, le casque peut considérer deux endroits du monde comme étant séparés de 4 mètres, puis affiner cette compréhension, en sachant que les emplacements sont en fait de 3,9 mètres de distance.</span><span class="sxs-lookup"><span data-stu-id="e1276-117">For example, the headset may currently believe two locations in the world to be 4 meters apart, and then later refine that understanding, learning that the locations are in fact 3.9 meters apart.</span></span> <span data-ttu-id="e1276-118">Si ces hologrammes avaient initialement été placés à 4 mètres en un seul système de coordonnées rigides, l’un d’eux présenterait toujours 0,1 mètres du monde réel.</span><span class="sxs-lookup"><span data-stu-id="e1276-118">If those holograms had initially been placed 4 meters apart in a single rigid coordinate system, one of them would then always appear 0.1 meters off from the real world.</span></span>

<span data-ttu-id="e1276-119">Vous pouvez placer manuellement les **ancres spatiales** dans Unity pour maintenir la position d’un hologramme dans le monde physique lorsque l’utilisateur est mobile. Toutefois, cela sacrifie l’auto-cohérence dans le monde virtuel.</span><span class="sxs-lookup"><span data-stu-id="e1276-119">You can manually place **spatial anchors** in Unity to maintain a hologram's position in the physical world when the user is mobile - however, this sacrifices the self-consistency within the virtual world.</span></span> <span data-ttu-id="e1276-120">Les différentes ancres se déplacent constamment les unes par rapport aux autres et se déplacent également dans l’espace de coordonnées global.</span><span class="sxs-lookup"><span data-stu-id="e1276-120">Different anchors are constantly moving in relation to one another, and are also moving through the global coordinate space.</span></span> <span data-ttu-id="e1276-121">Dans ce scénario, des tâches simples telles que la mise en page deviennent difficiles et la simulation physique pose problème.</span><span class="sxs-lookup"><span data-stu-id="e1276-121">In this scenario, simple tasks like layout become difficult and physics simulation problematic.</span></span>

<span data-ttu-id="e1276-122">Les **outils de verrouillage universel** vous offrent le meilleur des deux mondes, en stabilisant un système de coordonnées rigides unique à l’aide d’une alimentation interne d’ancres spatiales réparties sur l’ensemble de la scène virtuelle à mesure que l’utilisateur se déplace.</span><span class="sxs-lookup"><span data-stu-id="e1276-122">**World Locking Tools** gets you the best of both worlds, stabilizing a single rigid coordinate system using an internal supply of spatial anchors spread throughout the virtual scene as the user moves around.</span></span> <span data-ttu-id="e1276-123">Les outils analysent les coordonnées de l’appareil photo et les ancres spatiales de chaque image.</span><span class="sxs-lookup"><span data-stu-id="e1276-123">The tools analyze the coordinates of the camera and those spatial anchors every frame.</span></span> <span data-ttu-id="e1276-124">Au lieu de modifier les coordonnées de tout le monde pour compenser les corrections dans les coordonnées de la tête de l’utilisateur, les outils corrigent simplement les coordonnées de l’en-tête à la place.</span><span class="sxs-lookup"><span data-stu-id="e1276-124">Instead of changing the coordinates of everything in the world to compensate for the corrections in the coordinates of the user's head, the tools just fix the head's coordinates instead.</span></span>

## <a name="choosing-your-world-locking-approach"></a><span data-ttu-id="e1276-125">Choix de votre approche de verrouillage universel</span><span class="sxs-lookup"><span data-stu-id="e1276-125">Choosing your world locking approach</span></span>

* <span data-ttu-id="e1276-126">**Nous vous recommandons** d’utiliser les **outils de verrouillage universel** pour tous vos besoins en matière de positionnement d’hologramme.</span><span class="sxs-lookup"><span data-stu-id="e1276-126">**Our recommendation** is to use **World Locking Tools** for all your hologram positioning needs.</span></span> 
    * <span data-ttu-id="e1276-127">Les outils de verrouillage universel offrent un système de coordonnées stable qui réduit les incohérences visibles entre les marqueurs virtuels et réels.</span><span class="sxs-lookup"><span data-stu-id="e1276-127">World Locking Tools provides a stable coordinate system that minimizes the visible inconsistencies between virtual and real world markers.</span></span> <span data-ttu-id="e1276-128">En d’autres termes, il verrouille l’ensemble de la scène avec un pool partagé d’ancres, au lieu de verrouiller chaque groupe d’objets avec la propre ancre individuelle du groupe.</span><span class="sxs-lookup"><span data-stu-id="e1276-128">Put another way, it world-locks the entire scene with a shared pool of anchors, rather than locking each group of objects with the group's own individual anchor.</span></span>
* <span data-ttu-id="e1276-129">**Pour unity 2019/2020 utilisant OpenXR ou le plug-in Windows XR**, vous devez utiliser **ARAnchorManager**</span><span class="sxs-lookup"><span data-stu-id="e1276-129">**For Unity 2019/2020 using OpenXR or the Windows XR Plugin**, you need to use **ARAnchorManager**</span></span>
* <span data-ttu-id="e1276-130">**Pour les versions Unity plus anciennes ou les projets WSA** , vous devez utiliser **WorldAnchor**</span><span class="sxs-lookup"><span data-stu-id="e1276-130">**For older Unity versions or WSA** projects, you need to use **WorldAnchor**</span></span>

## <a name="setting-up-world-locking"></a><span data-ttu-id="e1276-131">Configuration du verrouillage universel</span><span class="sxs-lookup"><span data-stu-id="e1276-131">Setting up world locking</span></span> 

[!INCLUDE[](includes/world-locking/world-locking-setup.md)]

## <a name="persistent-world-locking"></a><span data-ttu-id="e1276-132">Verrouillage de monde persistant</span><span class="sxs-lookup"><span data-stu-id="e1276-132">Persistent world locking</span></span>

<span data-ttu-id="e1276-133">Les ancres spatiales enregistrent les hologrammes dans un espace réel entre les sessions d’application.</span><span class="sxs-lookup"><span data-stu-id="e1276-133">Spatial anchors save holograms in real-world space between application sessions.</span></span> <span data-ttu-id="e1276-134">Une fois enregistrées dans le magasin d’ancres HoloLens, elles peuvent être recherchées et chargées dans différentes sessions et constituent une solution de secours idéale en l’absence de connectivité Internet.</span><span class="sxs-lookup"><span data-stu-id="e1276-134">Once saved in the HoloLens' anchor store, they can be found and loaded in different sessions and are an ideal fallback when there's no internet connectivity.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e1276-135">Les ancres locales sont stockées sur l’appareil, alors que les ancres spatiales Azure sont stockées dans le cloud.</span><span class="sxs-lookup"><span data-stu-id="e1276-135">Local anchors are stored on device, while Azure Spatial Anchors are stored in the cloud.</span></span> <span data-ttu-id="e1276-136">Si vous envisagez d’utiliser les services cloud Azure pour stocker vos ancres, nous avons créé un guide qui vous aidera à intégrer [Azure Spatial Anchors](../mixed-reality-cloud-services.md#azure-spatial-anchors).</span><span class="sxs-lookup"><span data-stu-id="e1276-136">If you're looking to use Azure cloud services to store your anchors, we have a document that can walk you through integrating [Azure Spatial Anchors](../mixed-reality-cloud-services.md#azure-spatial-anchors).</span></span> <span data-ttu-id="e1276-137">Notez que vous pouvez avoir des ancres locales et Azure dans le même projet sans conflit.</span><span class="sxs-lookup"><span data-stu-id="e1276-137">Note that you can have local and Azure anchors in the same project without conflict.</span></span>

[!INCLUDE[](includes/world-locking/world-locking-persistence.md)]

## <a name="sharing-coordinate-spaces"></a><span data-ttu-id="e1276-138">Partage des espaces de coordonnées</span><span class="sxs-lookup"><span data-stu-id="e1276-138">Sharing coordinate spaces</span></span> 

<span data-ttu-id="e1276-139">Si vous souhaitez partager un espace de coordonnées universel, consultez notre documentation complète sur l' [expérience partagée](shared-experiences-in-unity.md).</span><span class="sxs-lookup"><span data-stu-id="e1276-139">If you want to share a world locked coordinate space, check out our comprehensive [shared experience documentation](shared-experiences-in-unity.md).</span></span>

<span data-ttu-id="e1276-140">Notez que les ancres spatiales Azure ne sont pas encore prises en charge directement dans les outils de verrouillage universel, et les expériences partagées vous obligent donc à créer manuellement des ancres spatiales.</span><span class="sxs-lookup"><span data-stu-id="e1276-140">Note that Azure Spatial Anchors is not yet supported directly within World Locking Tools, and so shared experiences will require you to manually create spatial anchors.</span></span>

## <a name="next-development-checkpoint"></a><span data-ttu-id="e1276-141">Point de contrôle de développement suivant</span><span class="sxs-lookup"><span data-stu-id="e1276-141">Next Development Checkpoint</span></span>

<span data-ttu-id="e1276-142">Si vous suivez le parcours du point de contrôle de développement Unity que nous avons mis en place, vous êtes au cœur de l’exploration des blocs de construction de la réalité mixte.</span><span class="sxs-lookup"><span data-stu-id="e1276-142">If you're following the Unity development checkpoint journey we've laid out, you're in the midst of exploring the Mixed Reality core building blocks.</span></span> <span data-ttu-id="e1276-143">À partir de là, vous pouvez passer au module suivant :</span><span class="sxs-lookup"><span data-stu-id="e1276-143">From here, you can continue to the next building block:</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="e1276-144">Mappage spatial</span><span class="sxs-lookup"><span data-stu-id="e1276-144">Spatial mapping</span></span>](spatial-mapping-in-unity.md)

<span data-ttu-id="e1276-145">Ou accéder aux API et fonctionnalités de la plateforme Mixed Reality :</span><span class="sxs-lookup"><span data-stu-id="e1276-145">Or jump to Mixed Reality platform capabilities and APIs:</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="e1276-146">Expériences partagées</span><span class="sxs-lookup"><span data-stu-id="e1276-146">Shared experiences</span></span>](shared-experiences-in-unity.md)

<span data-ttu-id="e1276-147">Vous pouvez revenir aux [points de contrôle de développement Unity](unity-development-overview.md#2-core-building-blocks) à tout moment.</span><span class="sxs-lookup"><span data-stu-id="e1276-147">You can always go back to the [Unity development checkpoints](unity-development-overview.md#2-core-building-blocks) at any time.</span></span>

## <a name="see-also"></a><span data-ttu-id="e1276-148">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="e1276-148">See Also</span></span>
* [<span data-ttu-id="e1276-149">Présentation des outils de verrouillage universel</span><span class="sxs-lookup"><span data-stu-id="e1276-149">World Locking Tools introduction</span></span>](https://microsoft.github.io/MixedReality-WorldLockingTools-Unity/DocGen/Documentation/IntroFAQ.html)
* [<span data-ttu-id="e1276-150">Guides de démarrage rapide</span><span class="sxs-lookup"><span data-stu-id="e1276-150">Quickstart guides</span></span>](https://microsoft.github.io/MixedReality-WorldLockingTools-Unity/DocGen/Documentation/HowTos/QuickStart.html)
* [<span data-ttu-id="e1276-151">Tutoriels</span><span class="sxs-lookup"><span data-stu-id="e1276-151">Tutorials</span></span>](https://microsoft.github.io/MixedReality-WorldLockingTools-Samples/Tutorial/01_Minimal/01_Minimal.html)
* [<span data-ttu-id="e1276-152">Exemples</span><span class="sxs-lookup"><span data-stu-id="e1276-152">Samples</span></span>](https://microsoft.github.io/MixedReality-WorldLockingTools-Unity/DocGen/Documentation/HowTos/SampleApplications.html)
* [<span data-ttu-id="e1276-153">Persistance d’ancrage spatial</span><span class="sxs-lookup"><span data-stu-id="e1276-153">Spatial anchor persistence</span></span>](../../design/coordinate-systems.md#spatial-anchor-persistence)
* <span data-ttu-id="e1276-154"><a href="/azure/spatial-anchors" target="_blank">Azure Spatial Anchors</a></span><span class="sxs-lookup"><span data-stu-id="e1276-154"><a href="/azure/spatial-anchors" target="_blank">Azure Spatial Anchors</a></span></span>
* <span data-ttu-id="e1276-155"><a href="/dotnet/api/Microsoft.Azure.SpatialAnchors" target="_blank">Kit de développement logiciel (SDK) d’ancre spatiale Azure pour Unity</a></span><span class="sxs-lookup"><span data-stu-id="e1276-155"><a href="/dotnet/api/Microsoft.Azure.SpatialAnchors" target="_blank">Azure Spatial Anchors SDK for Unity</a></span></span>
* [<span data-ttu-id="e1276-156">Échelle de l’expérience</span><span class="sxs-lookup"><span data-stu-id="e1276-156">Experience scales</span></span>](../../design/coordinate-systems.md#mixed-reality-experience-scales)
* [<span data-ttu-id="e1276-157">Étape spatiale</span><span class="sxs-lookup"><span data-stu-id="e1276-157">Spatial stage</span></span>](../../design/coordinate-systems.md#stage-frame-of-reference)
* [<span data-ttu-id="e1276-158">Suivi des pertes dans Unity</span><span class="sxs-lookup"><span data-stu-id="e1276-158">Tracking loss in Unity</span></span>](tracking-loss-in-unity.md)
* [<span data-ttu-id="e1276-159">Ancres spatiales</span><span class="sxs-lookup"><span data-stu-id="e1276-159">Spatial anchors</span></span>](../../design/spatial-anchors.md)
* [<span data-ttu-id="e1276-160">Expériences partagées dans Unity</span><span class="sxs-lookup"><span data-stu-id="e1276-160">Shared experiences in Unity</span></span>](shared-experiences-in-unity.md)

---
title: Système principal
description: Système d’entrée, gestionnaires d’appareils et fournisseurs de données dans MRTK
author: cDiaz-MS
ms.author: cadia
ms.date: 01/12/2021
keywords: Unity, HoloLens, HoloLens 2, réalité mixte, développement, MRTK, événements
ms.openlocfilehash: 12719a6c749a03648d4f75e9e6461b85cc9ab275
ms.sourcegitcommit: c0ba7d7bb57bb5dda65ee9019229b68c2ee7c267
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/19/2021
ms.locfileid: "110144293"
---
# <a name="core-system"></a><span data-ttu-id="aa9c7-104">Système de base</span><span class="sxs-lookup"><span data-stu-id="aa9c7-104">Core system</span></span>

<span data-ttu-id="aa9c7-105">Au cœur du système d’entrée se trouve le [InputSystem](../features/input/overview.md), qui est un service responsable de l’initialisation et de l’utilisation de toutes les fonctionnalités d’entrée associées à MRTK.</span><span class="sxs-lookup"><span data-stu-id="aa9c7-105">At the heart of the input system is the [InputSystem](../features/input/overview.md), which is a service that is responsible for initializing and operating all of the input related functionality associated with the MRTK.</span></span>

> [!NOTE]
> <span data-ttu-id="aa9c7-106">Il est supposé que les lecteurs ont déjà lu et ont une compréhension de base de la section [terminologie](terminology.md) .</span><span class="sxs-lookup"><span data-stu-id="aa9c7-106">It is assumed that readers have already read and have a basic understanding of the [terminology](terminology.md) section.</span></span>

<span data-ttu-id="aa9c7-107">Ce service est responsable des tâches suivantes :</span><span class="sxs-lookup"><span data-stu-id="aa9c7-107">This service is responsible for:</span></span>

- <span data-ttu-id="aa9c7-108">Lecture du [profil de système d’entrée](../configuration/mixed-reality-configuration-guide.md#input-system-settings)</span><span class="sxs-lookup"><span data-stu-id="aa9c7-108">Reading the [input system profile](../configuration/mixed-reality-configuration-guide.md#input-system-settings)</span></span>
- <span data-ttu-id="aa9c7-109">Démarrage des [fournisseurs de données](../features/input/input-providers.md) configurés (par exemple, `Windows Mixed Reality Device Manager` et `OpenVR Device Manager` ).</span><span class="sxs-lookup"><span data-stu-id="aa9c7-109">Starting the configured [data providers](../features/input/input-providers.md) (for example, `Windows Mixed Reality Device Manager` and `OpenVR Device Manager`).</span></span>
- <span data-ttu-id="aa9c7-110">Instanciation de [GazeProvider](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityGazeProvider), qui est un composant qui est chargé de fournir les informations de pointage de la tête de style hololens (1re génération) en plus des informations sur le regard de style hololens 2.</span><span class="sxs-lookup"><span data-stu-id="aa9c7-110">Instantiation of the [GazeProvider](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityGazeProvider), which is a component that is responsible for providing HoloLens (1st generation) style head gaze information in addition to HoloLens 2 style eye gaze information.</span></span>
- <span data-ttu-id="aa9c7-111">Instanciation de [FocusProvider](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityFocusProvider), qui est un composant responsable de la détermination des objets qui ont le focus.</span><span class="sxs-lookup"><span data-stu-id="aa9c7-111">Instantiation of the [FocusProvider](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityFocusProvider), which is a component that is responsible for determining objects that have focus.</span></span> <span data-ttu-id="aa9c7-112">Cela est décrit plus en détail dans la section [pointeurs et Focus](controllers-pointers-and-focus.md#pointers-and-focus) de la documentation.</span><span class="sxs-lookup"><span data-stu-id="aa9c7-112">This is described in more depth in the [pointers and focus](controllers-pointers-and-focus.md#pointers-and-focus) section of the documentation.</span></span>
- <span data-ttu-id="aa9c7-113">Fourniture de points d’enregistrement pour tous les événements d’entrée (en tant qu' [écouteurs globaux](#global-listeners)).</span><span class="sxs-lookup"><span data-stu-id="aa9c7-113">Providing registration points for all input events (as [global listeners](#global-listeners)).</span></span>
- <span data-ttu-id="aa9c7-114">Fournir des fonctionnalités de répartition des événements pour ces événements d’entrée.</span><span class="sxs-lookup"><span data-stu-id="aa9c7-114">Providing event dispatch capabilities for those input events.</span></span>

## <a name="input-events"></a><span data-ttu-id="aa9c7-115">Événements d’entrée</span><span class="sxs-lookup"><span data-stu-id="aa9c7-115">Input events</span></span>

<span data-ttu-id="aa9c7-116">Les événements d’entrée sont généralement déclenchés sur deux canaux différents :</span><span class="sxs-lookup"><span data-stu-id="aa9c7-116">Input events are generally fired on two different channels:</span></span>

### <a name="objects-in-focus"></a><span data-ttu-id="aa9c7-117">Objets en focus</span><span class="sxs-lookup"><span data-stu-id="aa9c7-117">Objects in focus</span></span>

<span data-ttu-id="aa9c7-118">Les événements peuvent être envoyés directement à un GameObject qui a le focus.</span><span class="sxs-lookup"><span data-stu-id="aa9c7-118">Events can be sent directly to a GameObject that has focus.</span></span> <span data-ttu-id="aa9c7-119">Par exemple, un objet peut avoir un script qui implémente [`IMixedRealityTouchHandler`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityTouchHandler) .</span><span class="sxs-lookup"><span data-stu-id="aa9c7-119">For example, an object might have a script that implements [`IMixedRealityTouchHandler`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityTouchHandler).</span></span>
<span data-ttu-id="aa9c7-120">Cet objet recevrait des événements tactiles lorsqu’il était ciblé par une main qui lui est proche.</span><span class="sxs-lookup"><span data-stu-id="aa9c7-120">This object would get touch events when focused by a hand that is near it.</span></span> <span data-ttu-id="aa9c7-121">Ces types d’événements vont « remonter » la hiérarchie GameObject jusqu’à ce qu’elle trouve un GameObject capable de gérer l’événement.</span><span class="sxs-lookup"><span data-stu-id="aa9c7-121">These types of events go "up" the GameObject hierarchy until it finds a GameObject that is capable of handling the event.</span></span>

<span data-ttu-id="aa9c7-122">Pour ce faire, utilisez [ExecuteHierarchy](https://docs.unity3d.com/ScriptReference/EventSystems.ExecuteEvents.ExecuteHierarchy.html) à partir de l’implémentation du système d’entrée par défaut.</span><span class="sxs-lookup"><span data-stu-id="aa9c7-122">This is done by using [ExecuteHierarchy](https://docs.unity3d.com/ScriptReference/EventSystems.ExecuteEvents.ExecuteHierarchy.html) from within the default input system implementation.</span></span>

### <a name="global-listeners"></a><span data-ttu-id="aa9c7-123">Écouteurs globaux</span><span class="sxs-lookup"><span data-stu-id="aa9c7-123">Global listeners</span></span>

<span data-ttu-id="aa9c7-124">Les événements peuvent être envoyés à des écouteurs globaux.</span><span class="sxs-lookup"><span data-stu-id="aa9c7-124">Events can be sent to global listeners.</span></span> <span data-ttu-id="aa9c7-125">Il est possible de s’inscrire pour tous les événements d’entrée à l’aide de l’interface du système d’entrée [`IMixedRealityEventSystem`](xref:Microsoft.MixedReality.Toolkit.IMixedRealityEventSystem) .</span><span class="sxs-lookup"><span data-stu-id="aa9c7-125">It's possible to register for all input events by using the input system's [`IMixedRealityEventSystem`](xref:Microsoft.MixedReality.Toolkit.IMixedRealityEventSystem) interface.</span></span> <span data-ttu-id="aa9c7-126">Il est recommandé d’utiliser la méthode [RegisterHandler](xref:Microsoft.MixedReality.Toolkit.IMixedRealityEventSystem.RegisterHandler%2A) pour l’inscription pour les événements globaux-la fonction déconseillée `Register` entraîne la notification de tous les événements d’entrée par les écouteurs, plutôt que simplement les événements d’entrée d’un type particulier (où le type est défini par l’interface d’événement).</span><span class="sxs-lookup"><span data-stu-id="aa9c7-126">It's recommended to use the [RegisterHandler](xref:Microsoft.MixedReality.Toolkit.IMixedRealityEventSystem.RegisterHandler%2A) method for registering for global events - the deprecated `Register` function will cause listeners to get notified of ALL input events, rather than just input events of a particular type (where type is defined by the event interface).</span></span>

<span data-ttu-id="aa9c7-127">Notez que les [écouteurs de secours](xref:Microsoft.MixedReality.Toolkit.Input.MixedRealityInputSystem.PushFallbackInputHandler%2A) sont un autre type d’écouteurs globaux qui sont également déconseillés, car ils recevront chaque événement d’entrée unique qui n’a pas été traité ailleurs dans la scène.</span><span class="sxs-lookup"><span data-stu-id="aa9c7-127">Note that [fallback listeners](xref:Microsoft.MixedReality.Toolkit.Input.MixedRealityInputSystem.PushFallbackInputHandler%2A) are another type of global listeners which are also discouraged because they will receive every single input event that hasn't been handled elsewhere in the scene.</span></span>

### <a name="order-of-event-dispatch"></a><span data-ttu-id="aa9c7-128">Ordre de répartition des événements</span><span class="sxs-lookup"><span data-stu-id="aa9c7-128">Order of event dispatch</span></span>

<span data-ttu-id="aa9c7-129">En règle générale, les événements sont envoyés aux écouteurs de la manière suivante.</span><span class="sxs-lookup"><span data-stu-id="aa9c7-129">Generally, events are sent to listeners in the following way.</span></span> <span data-ttu-id="aa9c7-130">Notez que si l’une des étapes ci-dessous marque l’événement comme [géré](https://docs.unity3d.com/ScriptReference/EventSystems.AbstractEventData-used.html), le processus de distribution d’événements s’arrête.</span><span class="sxs-lookup"><span data-stu-id="aa9c7-130">Note that if any of the steps below mark the event as [handled](https://docs.unity3d.com/ScriptReference/EventSystems.AbstractEventData-used.html), the event dispatch process stops.</span></span>

1. <span data-ttu-id="aa9c7-131">L’événement est envoyé aux écouteurs globaux.</span><span class="sxs-lookup"><span data-stu-id="aa9c7-131">Event is sent to global listeners.</span></span>
2. <span data-ttu-id="aa9c7-132">L’événement est envoyé aux boîtes de dialogue modales de l’objet ayant le focus.</span><span class="sxs-lookup"><span data-stu-id="aa9c7-132">Event is sent to modal dialogs of the focused object.</span></span>
3. <span data-ttu-id="aa9c7-133">L’événement est envoyé à l’objet ayant le focus.</span><span class="sxs-lookup"><span data-stu-id="aa9c7-133">Event is sent to the focused object.</span></span>
4. <span data-ttu-id="aa9c7-134">L’événement est envoyé aux écouteurs de secours.</span><span class="sxs-lookup"><span data-stu-id="aa9c7-134">Event is sent to fallback listeners.</span></span>

## <a name="device-managers-and-data-providers"></a><span data-ttu-id="aa9c7-135">Gestionnaires d’appareils et fournisseurs de données</span><span class="sxs-lookup"><span data-stu-id="aa9c7-135">Device managers and data providers</span></span>

<span data-ttu-id="aa9c7-136">Ces entités sont chargées d’interfaçage avec les API de niveau inférieur (telles que les API Windows Mixed Reality ou les API OpenVR) et de traduire les données de ces systèmes dans celles qui correspondent aux abstractions d’entrée de niveau supérieur du MRTK.</span><span class="sxs-lookup"><span data-stu-id="aa9c7-136">These entities are responsible for interfacing with lower-level APIs (such as Windows Mixed Reality APIs, or OpenVR APIs) and translating data from those systems into ones that fit the MRTK's higher level input abstractions.</span></span> <span data-ttu-id="aa9c7-137">Ils sont chargés de la détection, de la création et de la gestion de la durée de vie des [contrôleurs](controllers-pointers-and-focus.md#controllers).</span><span class="sxs-lookup"><span data-stu-id="aa9c7-137">They are responsible for detecting, creating, and managing the lifetime of [controllers](controllers-pointers-and-focus.md#controllers).</span></span>

<span data-ttu-id="aa9c7-138">Le workflow de base d’un gestionnaire de périphériques implique les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="aa9c7-138">The basic flow of a device manager involves:</span></span>

1. <span data-ttu-id="aa9c7-139">Le gestionnaire de périphériques est instancié par le service du système d’entrée.</span><span class="sxs-lookup"><span data-stu-id="aa9c7-139">The device manager is instantiated by the input system service.</span></span>
2. <span data-ttu-id="aa9c7-140">Le gestionnaire de périphériques s’inscrit auprès de son système sous-jacent (par exemple, le gestionnaire d’appareils Windows Mixed Reality Manager s’inscrit pour les événements [d’entrée](../features/input/input-events.md) et de [mouvement](../features/input/gestures.md#gesture-events) .</span><span class="sxs-lookup"><span data-stu-id="aa9c7-140">The device manager registers with its underlying system (for example, the Windows Mixed Reality device manager will register for [input](../features/input/input-events.md) and [gesture](../features/input/gestures.md#gesture-events) events.</span></span>
3. <span data-ttu-id="aa9c7-141">Elle crée des contrôleurs qu’elle découvre à partir du système sous-jacent (par exemple, le fournisseur peut détecter la présence de mains articulées).</span><span class="sxs-lookup"><span data-stu-id="aa9c7-141">It creates controllers that it discovers from the underlying system (for example the provider could detect the presence of articulated hands)</span></span>
4. <span data-ttu-id="aa9c7-142">Dans sa boucle Update (), appelez UpdateController () pour interroger le nouvel État du système sous-jacent et mettre à jour sa représentation de contrôleur.</span><span class="sxs-lookup"><span data-stu-id="aa9c7-142">In its Update() loop, call UpdateController() to poll for the new state of the underlying system and update its controller representation.</span></span>

---
title: Entrée d’un enregistrement d’animation
description: Documentation sur le système d’enregistrement d’animation d’entrée dans MRTK
author: CDiaz-MS
ms.author: cadia
ms.date: 01/12/2021
keywords: Unity, HoloLens, HoloLens 2, Mixed Reality, développement, MRTK
ms.openlocfilehash: 6bdb764c5905352b9aec7c1512a73e727b60573a
ms.sourcegitcommit: f338b1f121a10577bcce08a174e462cdc86d5874
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/01/2021
ms.locfileid: "113176942"
---
# <a name="input-animation-recording"></a><span data-ttu-id="66104-104">Entrée d’un enregistrement d’animation</span><span class="sxs-lookup"><span data-stu-id="66104-104">Input animation recording</span></span>

<span data-ttu-id="66104-105">MRTK comporte un système d’enregistrement par lequel les données de mouvement des têtes et de suivi des mains peuvent être stockées dans des fichiers d’animation.</span><span class="sxs-lookup"><span data-stu-id="66104-105">MRTK features an recording system by which head movement and hand tracking data can be stored in animation files.</span></span> <span data-ttu-id="66104-106">Les données enregistrées peuvent ensuite être lues à l’aide du [système de simulation d’entrée](input-simulation-service.md).</span><span class="sxs-lookup"><span data-stu-id="66104-106">The recorded data can then be played back using the [input simulation system](input-simulation-service.md).</span></span>

<span data-ttu-id="66104-107">L’enregistrement d’entrée est un outil utile dans différentes situations :</span><span class="sxs-lookup"><span data-stu-id="66104-107">Recording input is a useful tool in a variety of situations:</span></span>

* <span data-ttu-id="66104-108">Création de tests automatisés pour l’interaction, les manipulations, les solveurs, etc. La création du déplacement des contrôleurs et des mains pour ces tests peut prendre du temps.</span><span class="sxs-lookup"><span data-stu-id="66104-108">Creating automated tests for interaction, manipulations, solvers, etc. Creating the movement of controllers and hands for these tests can be time consuming.</span></span> <span data-ttu-id="66104-109">L’enregistrement d’une entrée directement peut accélérer le processus et fournir des données réelles.</span><span class="sxs-lookup"><span data-stu-id="66104-109">Recording input directly can speed up the process and provide real-world data.</span></span>
* <span data-ttu-id="66104-110">Apprentissage de l’utilisation d’éléments UX à travers les animations.</span><span class="sxs-lookup"><span data-stu-id="66104-110">Teaching the use of UX elements through animations.</span></span>
  <span data-ttu-id="66104-111">Montrer aux utilisateurs comment interagir avec les boutons et d’autres objets peut lisser la courbe d’apprentissage.</span><span class="sxs-lookup"><span data-stu-id="66104-111">Showing users how to interact with buttons and other objects can smooth the learning curve.</span></span>
* <span data-ttu-id="66104-112">Débogage d’un comportement inattendu qui peut se produire lors d’une utilisation normale.</span><span class="sxs-lookup"><span data-stu-id="66104-112">Debugging unexpected behavior that may be encountered during regular use.</span></span>
  <span data-ttu-id="66104-113">Le système d’enregistrement prend en charge un concept de « tampon enchaîné » qui permet d’enregistrer les entrées récentes en arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="66104-113">The recording system supports a "rolling buffer" concept that allows recording recent input in the background.</span></span>
  <span data-ttu-id="66104-114">Consultez [service d’enregistrement d’entrée](#input-recording-service).</span><span class="sxs-lookup"><span data-stu-id="66104-114">See [Input Recording Service](#input-recording-service).</span></span>

## <a name="recording-and-playback-services"></a><span data-ttu-id="66104-115">Services d’enregistrement et de lecture</span><span class="sxs-lookup"><span data-stu-id="66104-115">Recording and playback services</span></span>

<span data-ttu-id="66104-116">Deux services de système d’entrée sont fournis pour enregistrer et lire les entrées respectivement.</span><span class="sxs-lookup"><span data-stu-id="66104-116">Two input system services are provided to record and play back input respectively.</span></span>

### <a name="input-recording-service"></a><span data-ttu-id="66104-117">Service d’enregistrement d’entrée</span><span class="sxs-lookup"><span data-stu-id="66104-117">Input recording service</span></span>

<span data-ttu-id="66104-118">[`InputRecordingService`](xref:Microsoft.MixedReality.Toolkit.Input.InputRecordingService) Récupère les données de la transformation principale de la caméra et des contrôleurs de la main active et les stocke dans une mémoire tampon interne.</span><span class="sxs-lookup"><span data-stu-id="66104-118">[`InputRecordingService`](xref:Microsoft.MixedReality.Toolkit.Input.InputRecordingService) takes data from the main camera transform and active hand controllers and stores it in an internal buffer.</span></span> <span data-ttu-id="66104-119">À la demande, ces données sont ensuite sérialisées en fichiers binaires pour le stockage et la relecture ultérieures.</span><span class="sxs-lookup"><span data-stu-id="66104-119">When requested this data is then serialized into binary files for storage and later replay.</span></span>

<a target="_blank" href="../images/input-simulation/MRTK_InputAnimation_RecordingDiagram.png">
  <img src="../images/input-simulation/MRTK_InputAnimation_RecordingDiagram.png" title="Animation d’entrée d’enregistrement" width="80%" alt="Recording diagram" class="center" />
</a>

<span data-ttu-id="66104-121">Pour démarrer l’enregistrement d’entrée [`StartRecording`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.StartRecording) , appelez la fonction.</span><span class="sxs-lookup"><span data-stu-id="66104-121">To start recording input call the [`StartRecording`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.StartRecording) function.</span></span> <span data-ttu-id="66104-122">[`StopRecording`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.StopRecording) interrompt l’enregistrement (mais ne supprime pas les données enregistrées jusqu’à présent, utilisez [`DiscardRecordedInput`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.DiscardRecordedInput) pour effectuer cette opération si nécessaire).</span><span class="sxs-lookup"><span data-stu-id="66104-122">[`StopRecording`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.StopRecording) will pause recording (but not discard the data recorded so far, use [`DiscardRecordedInput`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.DiscardRecordedInput) to do this if needed).</span></span>

<span data-ttu-id="66104-123">Par défaut, la taille de la mémoire tampon d’enregistrement est limitée à 30 secondes.</span><span class="sxs-lookup"><span data-stu-id="66104-123">By default the size of the recording buffer is limited to 30 seconds.</span></span> <span data-ttu-id="66104-124">Cela permet au service d’enregistrement de conserver l’enregistrement en arrière-plan sans accumuler trop de données, puis d’enregistrer les 30 dernières secondes si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="66104-124">This allows the recording service to keep recording in the background without accumulating too much data, and then save the last 30 seconds when required.</span></span> <span data-ttu-id="66104-125">L’intervalle de temps peut être modifié à l’aide de la [`RecordingBufferTimeLimit`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.RecordingBufferTimeLimit) propriété, ou l’enregistrement peut être illimité à l’aide de l' [`UseBufferTimeLimit`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.UseBufferTimeLimit) option.</span><span class="sxs-lookup"><span data-stu-id="66104-125">The time interval can be changed using the [`RecordingBufferTimeLimit`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.RecordingBufferTimeLimit) property, or recording can be unlimited using the [`UseBufferTimeLimit`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.UseBufferTimeLimit) option.</span></span>

<span data-ttu-id="66104-126">Les données de la mémoire tampon d’enregistrement peuvent être enregistrées dans un fichier binaire à l’aide de la fonction [SaveInputAnimation](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.SaveInputAnimation*) .</span><span class="sxs-lookup"><span data-stu-id="66104-126">The data in the recording buffer can be saved in a binary file using the [SaveInputAnimation](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputRecordingService.SaveInputAnimation*) function.</span></span>

<span data-ttu-id="66104-127">Pour plus d’informations sur le format de fichier binaire, consultez [spécification de format de fichier d’animation d’entrée](input-animation-file-format.md).</span><span class="sxs-lookup"><span data-stu-id="66104-127">For details on the binary file format see [Input Animation File Format Specification](input-animation-file-format.md).</span></span>

### <a name="input-playback-service"></a><span data-ttu-id="66104-128">Service de lecture d’entrée</span><span class="sxs-lookup"><span data-stu-id="66104-128">Input playback service</span></span>

<span data-ttu-id="66104-129">[`InputPlaybackService`](xref:Microsoft.MixedReality.Toolkit.Input.InputPlaybackService) lit un fichier binaire avec les données d’animation d’entrée, puis applique ces données via le [InputSimulationService](xref:Microsoft.MixedReality.Toolkit.Input.InputSimulationService) pour recréer les mouvements enregistrés.</span><span class="sxs-lookup"><span data-stu-id="66104-129">[`InputPlaybackService`](xref:Microsoft.MixedReality.Toolkit.Input.InputPlaybackService) reads a binary file with input animation data and then applies this data through the [InputSimulationService](xref:Microsoft.MixedReality.Toolkit.Input.InputSimulationService) to recreate the recorded movements.</span></span>

<a target="_blank" href="../images/input-simulation/MRTK_InputAnimation_PlaybackDiagram.png">
  <img src="../images/input-simulation/MRTK_InputAnimation_PlaybackDiagram.png" title="Lire une animation d’entrée" width="80%" alt="Play Back diagram" class="center" />
</a>

<span data-ttu-id="66104-131">Pour commencer à lire une animation d’entrée, celle-ci doit être chargée à partir d’un fichier à l’aide de la fonction [LoadInputAnimation](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.LoadInputAnimation*) .</span><span class="sxs-lookup"><span data-stu-id="66104-131">To start playing back input animation it should be loaded from a file using the [LoadInputAnimation](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.LoadInputAnimation*) function.</span></span>

<span data-ttu-id="66104-132">Appelez [Play](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.Play), [Pause](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.Play)ou [Stop](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.Stop) pour contrôler la lecture de l’animation.</span><span class="sxs-lookup"><span data-stu-id="66104-132">Call [Play](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.Play), [Pause](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.Play), or [Stop](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.Stop) to control the animation playback.</span></span>

<span data-ttu-id="66104-133">L’heure actuelle de l’animation peut également être contrôlée directement avec la propriété [localtime](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.LocalTime) .</span><span class="sxs-lookup"><span data-stu-id="66104-133">The current animation time can also be controlled directly with the [LocalTime](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.LocalTime) property.</span></span>

> [!WARNING]
> <span data-ttu-id="66104-134">Le bouclage ou la réinitialisation [`LocalTime`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.LocalTime) directe de l’animation ou du paramètre en cas de nettoyage de la chronologie peut produire des résultats inattendus lors de la manipulation de la scène !</span><span class="sxs-lookup"><span data-stu-id="66104-134">Looping or resetting input animation or setting [`LocalTime`](xref:Microsoft.MixedReality.Toolkit.Input.IMixedRealityInputPlaybackService.LocalTime) directly by scrubbing the timeline may yield unexpected results when manipulating the scene!</span></span> <span data-ttu-id="66104-135">Seuls les mouvements d’entrée sont enregistrés, les modifications supplémentaires, telles que le déplacement d’objets ou le basculement de commutateurs, ne sont pas réinitialisées.</span><span class="sxs-lookup"><span data-stu-id="66104-135">Only the input movements are recorded, any additional changes such as moving objects or flipping switches will not be reset.</span></span> <span data-ttu-id="66104-136">Veillez à recharger la scène si des modifications irréversibles ont été apportées.</span><span class="sxs-lookup"><span data-stu-id="66104-136">Make sure to reload the scene if irreversible changes have been made.</span></span>

### <a name="editor-tools-for-recording-and-playing-input-animation"></a><span data-ttu-id="66104-137">Outils de l’éditeur pour l’enregistrement et la diffusion d’une animation d’entrée</span><span class="sxs-lookup"><span data-stu-id="66104-137">Editor tools for recording and playing input animation</span></span>

<span data-ttu-id="66104-138">Un certain nombre d’outils sont disponibles dans l’éditeur Unity pour l’enregistrement et l’examen de l’animation d’entrée.</span><span class="sxs-lookup"><span data-stu-id="66104-138">A number of tools exist in the Unity editor for recording and examining input animation.</span></span> <span data-ttu-id="66104-139">ces outils sont accessibles dans la [fenêtre outils de simulation d’entrée](input-simulation-service.md#input-simulation-tools-window), qui peut être ouverte à partir de la _réalité mixte Shared Computer Toolkit > utilitaires > menu simulation d’entrée_ .</span><span class="sxs-lookup"><span data-stu-id="66104-139">These tools can be accessed in the [input simulation tools window](input-simulation-service.md#input-simulation-tools-window), which can be opened from the _Mixed Reality Toolkit > Utilities > Input Simulation_ menu.</span></span>

> [!NOTE]
> <span data-ttu-id="66104-140">L’enregistrement et la lecture en entrée ne fonctionnent qu’en mode lecture.</span><span class="sxs-lookup"><span data-stu-id="66104-140">Input recording and playback only works during play mode.</span></span>

<span data-ttu-id="66104-141">La fenêtre d’enregistrement d’entrée a deux modes :</span><span class="sxs-lookup"><span data-stu-id="66104-141">The input recording window has two modes:</span></span>

* <span data-ttu-id="66104-142">_Enregistrement_ de l’entrée d’enregistrement en mode lecture et enregistrement de celle-ci dans des fichiers d’animation.</span><span class="sxs-lookup"><span data-stu-id="66104-142">_Recording_ for recording input during play mode and saving it to animation files.</span></span>

  <span data-ttu-id="66104-143">Lorsque vous activez le bouton enregistrement, le [`InputRecordingService`](xref:Microsoft.MixedReality.Toolkit.Input.InputRecordingService) est activé pour enregistrer l’entrée.</span><span class="sxs-lookup"><span data-stu-id="66104-143">When toggling on the recording button the [`InputRecordingService`](xref:Microsoft.MixedReality.Toolkit.Input.InputRecordingService) is enabled to record input.</span></span>
  <span data-ttu-id="66104-144">Quand vous désactivez le bouton enregistrement, la sélection enregistrer un fichier est affichée et l’animation d’entrée enregistrée est enregistrée dans la destination sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="66104-144">When toggling off the recording button a file save selection is shown and the recorded input animation is saved to the selected destination.</span></span>

  <span data-ttu-id="66104-145">La limite de temps de la mémoire tampon peut également être modifiée dans ce mode.</span><span class="sxs-lookup"><span data-stu-id="66104-145">The buffer time limit can also be changed in this mode.</span></span>

* <span data-ttu-id="66104-146">_Lecture_ pour le chargement des fichiers d’animation, puis recréation de l’entrée via le système de simulation d’entrée.</span><span class="sxs-lookup"><span data-stu-id="66104-146">_Playback_ for loading animation files and then recreating input through the input simulation system.</span></span>

  <span data-ttu-id="66104-147">Une animation doit d’abord être chargée dans ce mode.</span><span class="sxs-lookup"><span data-stu-id="66104-147">An animation must be loaded in this mode first.</span></span> <span data-ttu-id="66104-148">Après l’enregistrement d’une entrée en mode d’enregistrement, l’animation qui en résulte est automatiquement chargée.</span><span class="sxs-lookup"><span data-stu-id="66104-148">After recording input in recording mode the resulting animation is automatically loaded.</span></span> <span data-ttu-id="66104-149">Vous pouvez également cliquer sur le bouton « charger » pour sélectionner un fichier d’animation existant.</span><span class="sxs-lookup"><span data-stu-id="66104-149">Alternatively click the "Load" button to select an existing animation file.</span></span>

  <span data-ttu-id="66104-150">Les boutons de contrôle d’heure de gauche à droite sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="66104-150">The time control buttons from left to right are:</span></span>

  * <span data-ttu-id="66104-151">_Réinitialisez_ l’heure de lecture au début de l’animation.</span><span class="sxs-lookup"><span data-stu-id="66104-151">_Reset_ the playback time to the start of the animation.</span></span>
  * <span data-ttu-id="66104-152">_Lisez_ l’animation en continu dans le temps.</span><span class="sxs-lookup"><span data-stu-id="66104-152">_Play_ animation continuously over time.</span></span>
  * <span data-ttu-id="66104-153">_Étape suivante d'_ une étape.</span><span class="sxs-lookup"><span data-stu-id="66104-153">_Step_ forward one time step.</span></span>

  <span data-ttu-id="66104-154">Le curseur peut également être utilisé pour effectuer un nettoyage dans la chronologie d’animation.</span><span class="sxs-lookup"><span data-stu-id="66104-154">The slider can also be used to scrub through the animation timeline.</span></span>

> [!WARNING]
> <span data-ttu-id="66104-155">L’animation ou la réinitialisation d’une animation d’entrée ou le nettoyage de la chronologie peut produire des résultats inattendus lors de la manipulation de la scène !</span><span class="sxs-lookup"><span data-stu-id="66104-155">Looping or resetting input animation or scrubbing the timeline may yield unexpected results when manipulating the scene!</span></span> <span data-ttu-id="66104-156">Seuls les mouvements d’entrée sont enregistrés, les modifications supplémentaires, telles que le déplacement d’objets ou le basculement de commutateurs, ne sont pas réinitialisées.</span><span class="sxs-lookup"><span data-stu-id="66104-156">Only the input movements are recorded, any additional changes such as moving objects or flipping switches will not be reset.</span></span> <span data-ttu-id="66104-157">Veillez à recharger la scène si des modifications irréversibles ont été apportées.</span><span class="sxs-lookup"><span data-stu-id="66104-157">Make sure to reload the scene if irreversible changes have been made.</span></span>
